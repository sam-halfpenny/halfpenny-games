<html>
    <h1>RISK (the game) probability calculator</h1>
    <p>no. troops in the attacking country:</p>
    <input type="number" id='c1'>
    <br>
    <p>no. troops in the defending country:</p>
    <input type="number" id='c2'>
    <button type="button" onclick="calculate()">calculate</button>
    <div id="output">The probability of you winning this battle is undefined</div>
    <script>function calculate(){
        c1 = document.getElementById('c1').value
        c2 = document.getElementById('c2').value
        wprob=5/12
        lprob=7/12
        bbasemax = parseInt(c1) + parseInt(c2)-2
        final = 0
        if(c1<2){
            alert('you must have more than 2 troops to attack')
        }
        if(c2<1){
            alert('you must have at least 1 troop in each country')
        }
        bbase=[]
        for(i=1;i<bbasemax+1;i++){
            bbase.push(Math.pow(2,i))
        }
        if(c2==1){
            var i
            for(i=0;i<c1-1;i++){
                if(i==0){
                    final+=wprob
                }
                else{
                    final+=wprob*Math.pow(lprob,i)
                }
            }
        }
        else{
            test=0
            pos=[]
            tot=[]
            cpos=[]
            prob=[]
            wl=[]
            ttot=0
            zero=0
            one=0
            c=0
            for(i=0;i<bbasemax;i++){
                cpos.push(0)
            }
            for(i=0;i<bbase[bbasemax-1];i++){
                for(c=0;c<bbase.length;c++){
                    if(((i%bbase[bbasemax-c-1])-(bbase[bbasemax-c-1]/2))>=0){
                        cpos[c]=1
                    }
                    else{
                        cpos[c]=0
                    }
                    test++
                }
                pos.push(cpos)
                cpos=[]
                for(j=0;j<bbasemax;j++){
                    cpos.push(0)
                }
            }
            for(i=0;i<pos.length;i++){
                prob.push([])
                one=0
                zero=0
                for(j=0;j<pos[i].length;j++){
                    if(pos[i][j]==0){
                        prob[i].push(lprob)
                        zero++
                    }
                    else{
                        one++
                        prob[i].push(wprob)
                    }
                }
                if(one>=c1-1){
                    wl.push(0)
                }
                if(zero>=c2){
                    wl.push(1)
                }
            }
            utot=0
            for(i=0;i<prob.length;i++){
                ttot=1
                for(j=0;j<prob[i].length;j++){
                    ttot=prob[i][j]*ttot
                }
                tot.push(ttot)
                utot+=ttot
            }
            for(i=0;i<wl.length;i++){
                if(wl[i]==1){
                    final+=tot[i]
                }
            }
        }
        document.getElementById('output').textContent =
            'The probability of you winning this battle is:' + final;
    }</script>
</html>